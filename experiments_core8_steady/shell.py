import multiprocessing
import numpy as np
import time
import random

import os
def fun(fid,train_num,seed,epoch,bsize):
    os.system(f'python single_train.py train_num={train_num} fid={fid} seed={seed} epoch={epoch} batch_size={bsize}')
def unfun(low_num,high_num,seed,epoch,bsize):
    os.system(f'python union_train.py low_num={low_num} high_num={high_num} seed={seed} epoch={epoch} batch_size={bsize}')

if __name__ == '__main__':
    seed_pol=[1]

    for seedx in seed_pol:
        ##########################################
        print("seed 1")
        print("---------------------------------------------------------------------")
        print("cost 200")
        print("single low")
        p = multiprocessing.Process(target=fun(fid='mid', train_num=200, seed=seedx, epoch=800, bsize=20))
        p.start()
        print("single high")
        p = multiprocessing.Process(target=fun(fid='high',train_num=50, seed=seedx, epoch=800, bsize=20))
        p.start()
        print('union 1:2')
        p = multiprocessing.Process(target=unfun(low_num=67, high_num=33, seed=seedx, epoch=800, bsize=20))
        p.start()
        print('union 1:3')
        p = multiprocessing.Process(target=unfun(low_num=85, high_num=28, seed=seedx, epoch=800, bsize=20))
        p.start()
        print('union 1:4')
        p = multiprocessing.Process(target=unfun(low_num=100, high_num=25, seed=seedx, epoch=800, bsize=20))
        p.start()
     #####################3
        print("cost 400")
        print("single low")
        p = multiprocessing.Process(target=fun(fid='mid', train_num=400, seed=seedx, epoch=800, bsize=20))
        p.start()
        print("single high")
        p = multiprocessing.Process(target=fun(fid='high', train_num=100, seed=seedx, epoch=800, bsize=20))
        p.start()
        print('union 1:2')
        p = multiprocessing.Process(target=unfun(low_num=133, high_num=66, seed=seedx, epoch=800, bsize=20))
        p.start()
        print('union 1:3')
        p = multiprocessing.Process(target=unfun(low_num=171, high_num=57, seed=seedx, epoch=800, bsize=20))
        p.start()
        print('union 1:4')
        p = multiprocessing.Process(target=unfun(low_num=200, high_num=50, seed=seedx, epoch=800, bsize=20))
        p.start()
   #####################3
        print("cost 600")
        print("single low")
        p = multiprocessing.Process(target=fun(fid='mid', train_num=600, seed=seedx, epoch=800, bsize=20))
        p.start()
        print("single high")
        p = multiprocessing.Process(target=fun(fid='high', train_num=150, seed=seedx, epoch=800, bsize=20))
        p.start()
        print('union 1:2')
        p = multiprocessing.Process(target=unfun(low_num=200, high_num=100, seed=seedx, epoch=800, bsize=20))
        p.start()
        print('union 1:3')
        p = multiprocessing.Process(target=unfun(low_num=257, high_num=85, seed=seedx, epoch=800, bsize=20))
        p.start()
        print('union 1:4')
        p = multiprocessing.Process(target=unfun(low_num=300, high_num=75, seed=seedx, epoch=800, bsize=20))
        p.start()
   #####################3
        print("cost 800")
        print("single low")
        p = multiprocessing.Process(target=fun(fid='mid', train_num=800, seed=seedx, epoch=800, bsize=20))
        p.start()
        print("single high")
        p = multiprocessing.Process(target=fun(fid='high', train_num=200, seed=seedx, epoch=800, bsize=20))
        p.start()
        print('union 1:2')
        p = multiprocessing.Process(target=unfun(low_num=266, high_num=133, seed=seedx, epoch=800, bsize=20))
        p.start()
        print('union 1:3')
        p = multiprocessing.Process(target=unfun(low_num=342, high_num=114, seed=seedx, epoch=800, bsize=20))
        p.start()
        print('union 1:4')
        p = multiprocessing.Process(target=unfun(low_num=400, high_num=100, seed=seedx, epoch=800, bsize=20))
        p.start()
        print("cost 1000")
        print("single low")
        p = multiprocessing.Process(target=fun(fid='mid', train_num=1000, seed=seedx, epoch=800, bsize=20))
        p.start()
        print("single high")
        p = multiprocessing.Process(target=fun(fid='high', train_num=250, seed=seedx, epoch=800, bsize=20))
        p.start()
        print('union 1:2')
        p = multiprocessing.Process(target=unfun(low_num=333, high_num=166, seed=seedx, epoch=800, bsize=20))
        p.start()
        print('union 1:3')
        p = multiprocessing.Process(target=unfun(low_num=428, high_num=142, seed=seedx, epoch=800, bsize=20))
        p.start()
        print('union 1:4')
        p = multiprocessing.Process(target=unfun(low_num=500, high_num=125, seed=seedx, epoch=800, bsize=20))
        p.start()
